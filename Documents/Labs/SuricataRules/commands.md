Task 1. Examine a custom rule in Suricata
The /home/analyst directory contains a custom.rules file that defines the network traffic rules, which Suricata captures.

In this task, you’ll explore the composition of the Suricata rule defined in the custom.rules file.

Use the cat command to display the rule in the custom.rules file:
- cat custom.rules

Task 2. Trigger a custom rule in Suricata
Now that you are familiar with the composition of the custom Suricata rule, you must trigger this rule and examine the alert logs that Suricata generates.

1. List the files in the /var/log/suricata folder:
- ls -l /var/log/suricata


2. Run suricata using the custom.rules and sample.pcap files:
- sudo suricata -r sample.pcap -S custom.rules -k none

This command starts the Suricata application and processes the sample.pcap file using the rules in the custom.rules file. It returns an output stating how many packets were processed by Suricata.

Now you’ll further examine the options in the command:

The -r sample.pcap option specifies an input file to mimic network traffic. In this case, the sample.pcap file.
The -S custom.rules option instructs Suricata to use the rules defined in the custom.rules file.
The -k none option instructs Suricata to disable all checksum checks.
As a refresher, checksums are a way to detect if a packet has been modified in transit. Because you are using network traffic from a sample packet capture file, you won't need Suricata to check the integrity of the checksum.

Suricata adds a new alert line to the /var/log/suricata/fast.log file when all the conditions in any of the rules are met.

3. List the files in the /var/log/suricata folder again:
- ls -l /var/log/suricata

4. Use the cat command to display the fast.log file generated by Suricata:
- cat fast.log

Each line or entry in the fast.log file corresponds to an alert generated by Suricata when it processes a packet that meets the conditions of an alert generating rule. Each alert line includes the message that identifies the rule that triggered the alert, as well as the source, destination, and direction of the traffic.

Task 3. Examine eve.json output
In this task, you must examine the additional output that Suricata generates in the eve.json file.

As previously mentioned, this file is located in the /var/log/suricata/ directory.

The eve.json file is the standard and main Suricata log file and contains a lot more data than the fast.log file. This data is stored in a JSON format, which makes it much more useful for analysis and processing by other applications.

1. Use the cat command to display the entries in the eve.json file:
- cat /var/log/suricata/eve.json

2. Use the jq command to display the entries in an improved format:
- jq . /var/log/suricata/eve.json | less

3. What is the value of the severity property for the first alert returned by the jq command?
- 3

4. Use the jq command to extract specific event data from the eve.json file:
- jq -c "[.timestamp,.flow_id,.alert.signature,.proto,.dest_ip]" /var/log/suricata/eve.json

5. What is the destination IP address listed for the last event in the 'eve.json' file?
- 142.250.1.102

6. What is the alert signature for the first alert entry in the 'eve.json' file?
- GET on wire
